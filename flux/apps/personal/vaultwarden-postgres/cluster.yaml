apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
    name: vaultwarden-postgres
    namespace: vaultwarden
spec:
    instances: 3
    storage:
        storageClass: rook-ceph-block
        size: 1Gi

    plugins:
        - name: barman-cloud.cloudnative-pg.io
          isWALArchiver: true
          parameters:
              barmanObjectName: vaultwarden-postgres

        - name: barman-cloud.cloudnative-pg.io
          isWALArchiver: false
          parameters:
              barmanObjectName: vaultwarden-postgres-b2
